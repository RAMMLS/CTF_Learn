```
Если сетевой и межсетевой уровень определяют маршрут до цели, то транспортный уровень - это как корабль, который курсирует по этому маршруту и швартуется у строго назначенной пристани.
```

## TCP & UDP 
- TCP - гарантирует стабильное устойчивое соединение без потерь
- UDP - обеспечивает быструю передачу данных с помощью дейтраграмм без **гарантии доставки**

**На транспортном уровне приложение, которое будет обрабатывать входящий трафик идентифицируетс портом**

**Порт** - уникальный номер в виде десятичного числа {0;65535} (16b). Причем для протоколов TCP && UDP используется различный набор портов.

Порты открываются на сетевом интерфейсе.

## Протокол TCP

Один из наиболее распространенных протоколов транспортного уровня. С его помощью функционируют: HTTP, SMTP, SSH etc.

### Основные принципы: 
- Трехстороннее рукопожатие для установления соединения
- Контроль целостности 
- Управление потоком
- Завершение соединения в штатных и аварийных ситуациях

**Передача информации выполняется сегментами**

## Трехстороннее рукопожатие

- [1] **SYN** (synchronize) - на целевой порт по IP адресу приходит TCP-сегмент с флагом SYN. В нем расположен начальный номер последовательности нумерации следующих данных
- [2] **SYN-ACK** (synchronize-acknowledge) - целевое устройство отвечает клиенту TCP-сегментом с флагами SYN && ACK подтверждая готовность к обмену информацией
- [3] **ACK** (acknowledge) - клиент отправляет на сервер фрагмент с флагом ACK (**Соединение установлено**)

## Контроль целостности

- Во время обменя TCP сегменты нумеруются
- Инициализирующее значение задается при установке соединения

**Контрольные суммы добавляются к каждому сегменту. Получатель вычисляет ее и сравнивает с переданной, в случае несовпадения - повтор**
**Подтверждение - получатель отправляет подтверждение после приема сегмента.**

## Управление потоком и завершение соединения

TCP обеспечивает регулировку скорости при помощи **скользящего окна**
```
Я лично реализовывал эту технологию во время выполнения контеста на яндекс студкемп
```

Количество передаваемых сегментов без подтверждения называется **размером окна**. Размер которого растет *аддитивно* 


Штатное завершение регламентируется за счет передачи флага **FIN**

## Сегмент и флаги TCP

![[Pasted image 20251119190806.png]]
